// geoFire is a helper library for location-based operations in Firebase.
// It provides functions to store data for location querying in Firebase,
// and perform location queries such as location updates and localized searches.
// geoFire stores the location coordinates of a data point as a geohash
// (http://en.wikipedia.org/wiki/Geohash) in Firebase.

var GeoFire = (function() {

function encode(n,e){var t,r,d,a=n[0],i=n[1],o="",h=0,u=0,m=1,c={min:-90,max:90},s={min:-180,max:180};if(e=Math.min(e||12,22),a<c.min||a>c.max)throw"Invalid latitude specified! ("+a+")";if(i<s.min||i>s.max)throw"Invalid longitude specified! ("+i+")";for(;o.length<e;)t=m?i:a,r=m?s:c,d=(r.min+r.max)/2,t>d?(h=(h<<1)+1,r.min=d):(h=(h<<1)+0,r.max=d),m=!m,4>u?u++:(u=0,o+=BASE32[h].toString(),h=0);return o}function halve_interval(n,e,t){var r=(n.min+n.max)/2;e&t?n.min=r:n.max=r}function decode(n){for(var e,t,r,d,a,i={min:-90,max:90},o={min:-180,max:180},h=1,u=0;u<n.length;u++){r=BASE32.indexOf(n[u]);for(var m=0;5>m;m++)a=h?o:i,d=BITS[m],halve_interval(a,r,d),h=!h}return e=(i.min+i.max)/2,t=(o.min+o.max)/2,[e,t]}function deg2rad(n){return n*Math.PI/180}function rad2deg(n){return 180*n/Math.PI}function rad2km(n){return 6371*n}function deg2km(n){return rad2km(deg2rad(n))}function miles2km(n){return 1.60934*n}function km2miles(n){return.621371*n}function dist(n,e,t,r){var d,a,i=6371,o=deg2rad(t-n),h=deg2rad(r-e);return d=Math.sin(o/2)*Math.sin(o/2)+Math.cos(deg2rad(n))*Math.cos(deg2rad(t))*Math.sin(h/2)*Math.sin(h/2),a=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),i*a}function distByHash(n,e){var t=decode(n),r=decode(e);return dist(t[0],t[1],r[0],r[1])}function dimensions(n){var e=n.length,t=e%2?1:0,r=5*e-t;return{height:deg2km(180/Math.pow(2,r/2)),width:deg2km(180/Math.pow(2,(r-1)/2))}}function neighbor(n,e){n=n.toLowerCase();var t=n.charAt(n.length-1),r=n.length%2?"odd":"even",d=n.substring(0,n.length-1);if(-1!=BORDERS[e][r].indexOf(t)){if(d.length<=0)return"";d=neighbor(d,e)}return d+BASE32[NEIGHBORS[e][r].indexOf(t)]}var Blah=function(){var n=5,e=7,t=n+e;console.log("test blah: "+t)},geoEncode=function(){},BITS=[16,8,4,2,1],BASE32="0123456789bcdefghjkmnpqrstuvwxyz",NEIGHBORS={north:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy",odd:"bc01fg45238967deuvhjyznpkmstqrwx"},east:{even:"bc01fg45238967deuvhjyznpkmstqrwx",odd:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},south:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb",odd:"238967debc01fg45kmstqrwxuvhjyznp"},west:{even:"238967debc01fg45kmstqrwxuvhjyznp",odd:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}},BORDERS={north:{even:"prxz",odd:"bcfguvyz"},east:{even:"bcfguvyz",odd:"prxz"},south:{even:"028b",odd:"0145hjnp"},west:{even:"0145hjnp",odd:"028b"}},noop=function(){},onSearches={},onCallbacks={};
var validateKey=function(o){throw new Error("Invalid key "+o)},validateLocation=function(o){throw new Error("Invalid location "+o)};geoFire.prototype.searchRadius=function(o,e){for(var t=[null,5003.771699005143,625.4714623756429,156.36786559391072,19.54598319923884,4.88649579980971,.6108119749762138],n=6;e>t[n];)n-=1};var GeoCBRegistration=function(o){this._onCancel=o};GeoCBRegistration.prototype.cancel=function(){this._onCancel()&&(this._onCancel(),delete this._onCancel)};var GeoQuery=function(){};GeoQuery.prototype=Promise.prototype,GeoQuery.prototype.onKey=function(){},GeoQuery.prototype.changeQuery=function(){},GeoQuery.prototype.cancel=function(){};var GeoFire=function(o){this._ref=o};GeoFire.prototype.set=function(o,e){validateKey(o),validateLocation(e)},GeoFire.prototype.get=function(o){validateKey(o)};
return GeoFire;
})();

//Make sure this works in node.
if (typeof module !== "undefined") {
  module.exports = GeoFire;
}
